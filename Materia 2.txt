Aula do dia 26/10/2023

Funções agregadas
AVG() - só pode ser utilizada em atributos numéricos - retorna a média
1 - Mostrar o valor médio do salário que os médicos recebem
SELECT AVG(SAL_MEDICO) SALARIO_MEDIO FROM MEDICO;

2 - Mostrar o nome dos médicos que recebem salário acima da média
SELECT NOM_MEDICO NOME FROM MEDICO
WHERE SAL_MEDICO >
(SELECT AVG(SAL_MEDICO) SALARIO_MEDIO FROM MEDICO);

SUM() - só pode ser utilizada em atributos numéricos - retorna a somatória
3 - Mostrar o total gasto com o pagamento de médicos
SELECT SUM(SAL_MEDICO) TOTAL FROM MEDICO;

COUNT() - retorna o número de linhas encontradas (contador)
4 - Mostrar quantos pacientes são do estado de SP
SELECT COUNT(COD_PACIENTE) QTD FROM PACIENTE WHERE
TO_UPPER(UF_PACIENTE) = 'SP';

5 - Mostrar a quantidade de pacientes por estado
SELECT UF_PACIENTE ESTADO, COUNT(COD_PACIENTE) QTD
FROM PACIENTE GROUP BY UF_PACIENTE;

6 - Mostrar a quantidade de pacientes por sexo
SELECT SEX_PACIENTE SEXO, COUNT(COD_PACIENTE) QTD
FROM PACIENTE GROUP BY SEX_PACIENTE;

7 - Mostrar a quantidade de exames realizados por tipo de exame
SELECT E.NOM_EXAME EXAME, COUNT(EL.COD_EXAME) QTD
FROM EXAME E, EXAME_LABORATORIO EL
WHERE E.COD_EXAME = EL.COD_EXAME
GROUP BY EL.NOM_EXAME;

MAX() - retorna o maior valor encontrado, caso o atributo seja
do tipo caracter ou string será considerada a ordem do alfabeto

8 - Mostar o nome do médico que recebe o maior salário
SELECT NOM_MEDICO FROM MEDICO WHERE
SAL_MEDICO = (SELECT MAX(SAL_MEDICO) FROM MEDICO);

MIN() - retorna o menor valor encontrado, cado o atributo seja
do tipo caracter ou string será considerada a ordem do alfabeto

9 - Mostrar o nome do exame que inicia com a letra mais próxima do início do alfabeto
SELECT MIN(NOM_EXAME) EXAME FROM EXAME;

Funções Oracle para manipulação de datas
TO_DATE() - converte caracteres/string em datas
TO_CHAR() - converte datas em caracteres - pode-se especificar o formato da data.
SYSDATE() - retorna a data do sistema onde está o servidor de banco de dados.

10 - Mostrar o nome dos pacientes que fazem aniversário no mês corrente.
SELECT NOM_PACIENTE NOME FROM PACIENTE
WHERE TO_CHAR(SYSDATE, 'MM') = TO_CHAR(DTN_PACIENTE, 'MM');


///////////////////////////////////////////////////

Aula do dia 16/11/2023

Gatilho - Trigger
Os gatilhos são programas PL/SQL que são executados automaticamente a partir
da ocorrência de um evento programado.

Sintaxe:
CREATE [OR REPLACE] TRIGGER "nome do gatilho"
BEFORE | AFTER INSERT OR UPDATE OR DELETE ON "nome da tabela"
FOR EACH ROW | STATEMENT
-- declaração de variáveis, se for necessário
BEGIN
-- instruções PL/SQL
END;




